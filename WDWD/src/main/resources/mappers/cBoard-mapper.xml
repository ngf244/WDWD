<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cBoardMapper">

	<select id="getListCount" parameterType="_int" resultType="_int">
		select count(*)
		from board
		where bo_del='N' and bo_group=#{ boGroup }
	</select>

	
	<select id="getBoardList" resultMap="boardResultSet">
	
		select *
		from board
		where bo_del='N'and bo_group=#{ boGroup }
		order by bo_num desc
		
	</select>
	
	<resultMap type="Board" id="boardResultSet">
		<id property="boNum" column="BO_NUM"/>
		<result property="boGroup" column="BO_GROUP"/>
		<result property="boTitle" column="BO_TITLE"/>
		<result property="boContent" column="BO_CON"/>
		<result property="boView" column="BO_VIEW"/>
		<result property="boDate" column="BO_DATE"/>
		<result property="boUpdate" column="BO_UPDATE"/>
		<result property="boDel" column="BO_DEL"/>
		<result property="boWriter" column="BO_WRITER"/>
		<result property="boGood" column="BO_GOOD"/>
		<result property="boCategory" column="BO_CATEGORY"/>
		<result property="boReNum" column="BO_RENUM"/>
	</resultMap>
   
   <resultMap type="CBoard" id="CBoardResultSet">
      <id property="boNum" column="BO_NUM"/>
      <result property="boGroup" column="BO_GROUP"/>
      <result property="boTitle" column="BO_TITLE"/>
      <result property="boContent" column="BO_CON"/>
      <result property="boView" column="BO_VIEW"/>
      <result property="boDate" column="BO_DATE"/>
      <result property="boUpdate" column="BO_UPDATE"/>
      <result property="boDel" column="BO_DEL"/>
      <result property="boWriter" column="BO_WRITER"/>
      <result property="boGood" column="BO_GOOD"/>
      <result property="boCategory" column="BO_CATEGORY"/>
      <result property="boReNum" column="BO_RENUM"/>
      <result property="cbStep" column="CB_STEP" />
      <result property="cbSecret" column="CB_SECRET" />
      <result property="cbCash" column="CB_CASH"/>
      <result property="cbCate" column="CB_CATE"/>
      <result property="cbStep1" column="CB_STEP1"/>
      <result property="cbStep2" column="CB_STEP2"/>
      <result property="cbStep3" column="CB_STEP3"/>
      <result property="cbStep4" column="CB_STEP4"/>
      <result property="cbStep5" column="CB_STEP5"/>
      <result property="cbDate" column="CB_DATE"/>
      <result property="cbPrimium" column="CB_PRIMIUM"/>
      <result property="reId" column="RE_ID"/>      
   </resultMap>
   
   <insert id="cBoardInsert1" parameterType="CBoard">
		insert into board
		values (bo_seq.nextval, #{boGroup}, #{boTitle}, #{boContent}, default, default, default, default, #{boWriter}, default, #{boCategory}, default)
	</insert>
	
	<insert id="cBoardInsert2" parameterType="CBoard">
		insert into cash_board
		values (bo_seq.currval, 1, #{cbSecret}, #{cbCash}, 1, #{cbStep1}, #{cbStep2}, #{cbStep3}, #{cbStep4}, #{cbStep5}, #{cbDate}, #{cbPrimium})
	</insert>
	
	<select id="cBoardDetail" parameterType="_int" resultMap="CBoardResultSet">
		select *
		from board
		join cash_board on (board.bo_num = cash_board.cb_num)
		where bo_num = #{boNum}
	</select>
 	
	<select id="getMyReqListCount" parameterType="CBoard" resultType="_int">
		select count(*)
		from board
			 join cash_board on (bo_num = cb_num)
		<where>
			<if test="boWriter != null">
				bo_writer = #{boWriter}
			</if>
			<if test="boGroup != null">
				and bo_group = #{boGroup}
			</if>
			<if test="cbStep != 0">
				and cb_step = #{cbStep}
			</if>
		</where>
	</select>
	
	<select id="selectMyReqList" parameterType="CBoard" resultMap="RequestResultSet">
		select *
		from board
			 join cash_board on (bo_num = cb_num)
		<if test="cbStep == 2">
			 left join request on (bo_num = re_num)
		</if>
		<if test="cbStep == 3">
			 left join request on (bo_num = re_num)
		</if>			 
		<where>
			<if test="boWriter != null">
				bo_writer = #{boWriter}
			</if>
			<if test="boGroup != null">
				and bo_group = #{boGroup}
			</if>
			<if test="cbStep != 0">
				and cb_step = #{cbStep}
			</if>
		</where> 
	</select>
	
	<resultMap type="Request" id="RequestResultSet">
		<id property="boNum" column="BO_NUM"/>
		<result property="boGroup" column="BO_GROUP"/>
		<result property="boTitle" column="BO_TITLE"/>
		<result property="boContent" column="BO_CON"/>
		<result property="boView" column="BO_VIEW"/>
		<result property="boDate" column="BO_DATE"/>
		<result property="boUpdate" column="BO_UPDATE"/>
		<result property="boDel" column="BO_DEL"/>
		<result property="boWriter" column="BO_WRITER"/>
		<result property="boGood" column="BO_GOOD"/>
		<result property="boCategory" column="BO_CATEGORY"/>
		<result property="boReNum" column="BO_RENUM"/>
		<result property="cbStep" column="CB_STEP" />
		<result property="cbSecret" column="CB_SECRET" />
		<result property="cbCash" column="CB_CASH"/>
		<result property="cbCate" column="CB_CATE"/>
		<result property="cbStep1" column="CB_STEP1"/>
		<result property="cbStep2" column="CB_STEP2"/>
		<result property="cbStep3" column="CB_STEP3"/>
		<result property="cbStep4" column="CB_STEP4"/>
		<result property="cbStep5" column="CB_STEP5"/>
		<result property="cbDate" column="CB_DATE"/>
		<result property="cbPrimium" column="CB_PRIMIUM"/>
		<result property="reNum" column="RE_NUM"/>
		<result property="reId" column="RE_ID"/>
		<result property="reCash" column="RE_CASH"/>
		<result property="rePlz" column="RE_PLZ"/>
		<result property="reRefNum" column="RE_REFNUM"/>
		<result property="reDate" column="RE_DATE"/>
		<result property="reGrade" column="RE_GRADE"/>		      
	</resultMap>	
	
	<select id="getMyWorkListCount" parameterType="Request" resultMap="RequestResultSet">
		select count(*)
		from board
		     join cash_board on (bo_num = cb_num)
		     left join request on (bo_num = re_num)
		<where>
			<if test="reId != null">
				re_id = #{reId}
			</if>
			<if test="boGroup != null">
				and bo_group = #{boGroup}
			</if>
			<if test="cbStep != 0">
				and cb_step = #{cbStep}
			</if>
		</where>     
	</select>
	
	<select id="selectMyWorkList" parameterType="Request" resultMap="RequestResultSet">
		select *
		from board
			 join cash_board on (bo_num = cb_num)
			 left join request on (bo_num = re_num)
		<where>
			<if test="reId != null">
				re_id = #{reId}
			</if>
			<if test="boGroup != null">
				and bo_group = #{boGroup}
			</if>
			<if test="cbStep != 0">
				and cb_step = #{cbStep}
			</if>
		</where>  	 
	</select>
	   	
</mapper>